---
title: "output"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{output}
  %\VignetteEngine{rmarkdown::render}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  eval=FALSE
)
```

# Output

CAMDAC outputs are written in the directory given by `config$outdir` in the format `PATIENT/DATASET/SAMPLE/`:

```
└── P
    ├── Allelecounts
    │   ├── N
    │   │   └── P.N.SNPs.CpGs.all.sorted.csv.gz
    │   └── T
    │       └── P.T.SNPs.CpGs.all.sorted.csv.gz
    ├── Copynumber
    │   ├── N
    │   │   └── P.N.SNPs.csv.gz
    │   └── T
    │       ├── ascat
    │       ├── battenberg
    │       ├── P.T.cna.txt
    │       ├── P.T.SNPs.csv.gz
    │       └── P.T.tnSNP.csv.gz
    └── Methylation
        ├── N
        │   └── P.N.m.csv.gz
        └── T
            ├── P.T.CAMDAC_annotated_DMRs.fst
            ├── P.T.CAMDAC_results_per_CpG.fst
            ├── P.T.m.csv.gz
            └── P.T.pure.csv.gz
```

| File | Description |
|------|-------------|
| `P1.T.SNPs.CpGs.all.sorted.csv.gz` | Allele counts for a sample. Generated by processing BAM file |
| `P1.T.SNPs.csv.gz` | SNP counts for a sample. |
| `P1.T.ascat.output.qs` | ASCAT raw output |
| `P1-T_subclones.txt` | Battenberg raw output |
| `P1.T.cna.txt` | CAMDAC CNA result |
| `P1.T.m.csv.gz` | Bulk methylation data |
| `P1.T.m.pure.csv.gz` | CAMDAC-deconvolved methylation data |
| `P1.T.CAMDAC_results_per_CpG.fst` | CAMDAC differentially methylation cytosine output |
| `P1.T.CAMDAC_annotated_DMRs.fst` | CAMDAC differentially methylated regions |

##  Manually assigning outputs to CAMDAC objects

If you have outputs from a previous run, you can manually assign them to a CAMDAC object. This overwrites the expected path for that output type, allowing parts of the pipeline to run with this data. Use the `attach_output` function, passing one of three arguments:

* `counts`: CAMDAC allele counts `*.SNP.CpGs.all.sorted.csv.gz` file
* `snps`: CAMDAC sample SNP counts `*.SNPs.csv.gz` file
* `meth`: CAMDAC bulk methylation `*.m.csv.gz` file
* `cna`: CAMDAC CNA `*.cna.txt` file
* `pure`: CAMDAC deconvolved methylation `*.m.pure.csv.gz` file

For example, to attach a previous counts file to a CAMDAC object:

```{r}
tumor <- CamSample(id = "T", sex = "XY", bam = NULL)
config <- CamConfig(outdir = tempdir(), build="hg38", bsseq="wgbs", lib="pe")
counts_file <- system.file("testdata", "test.SNPs.CpGs.all.sorted.csv.gz", package = "CAMDAC")
tumor <- attach_output(tumor, config, "counts", counts_file)
```

The CAMDAC pipeline can now access the file in the expected location at `config$outdir`.
